!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("react"),require("proxy-compare"),require("use-sync-external-store/shim"),require("valtio/vanilla")):"function"==typeof define&&define.amd?define(["exports","react","proxy-compare","use-sync-external-store/shim","valtio/vanilla"],r):r((e="undefined"!=typeof globalThis?globalThis:e||self).valtio={},e.React,e.proxyCompare,e.useSyncExternalStoreExports,e.valtioVanilla)}(this,(function(e,r,t,n,u){"use strict";function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var a=o(n).default.useSyncExternalStore;Object.defineProperty(e,"getVersion",{enumerable:!0,get:function(){return u.getVersion}}),Object.defineProperty(e,"proxy",{enumerable:!0,get:function(){return u.proxy}}),Object.defineProperty(e,"ref",{enumerable:!0,get:function(){return u.ref}}),Object.defineProperty(e,"snapshot",{enumerable:!0,get:function(){return u.snapshot}}),Object.defineProperty(e,"subscribe",{enumerable:!0,get:function(){return u.subscribe}}),Object.defineProperty(e,"unstable_getHandler",{enumerable:!0,get:function(){return u.getHandler}}),e.useSnapshot=function(e,n){var o=null==n?void 0:n.sync,i=r.useRef(),c=r.useRef(),s=!0,f=a(r.useCallback((function(r){var t=u.subscribe(e,r,o);return r(),t}),[e,o]),(function(){var r=u.snapshot(e);try{if(!s&&i.current&&c.current&&!t.isChanged(i.current,r,c.current,new WeakMap))return i.current}catch(e){}return r}),(function(){return u.snapshot(e)}));s=!1;var l=new WeakMap;r.useEffect((function(){i.current=f,c.current=l}));var p=r.useMemo((function(){return new WeakMap}),[]);return t.createProxy(f,l,p)},Object.defineProperty(e,"__esModule",{value:!0})}));
